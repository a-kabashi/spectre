import pymongo
from pymongo import MongoClient
import datetime

# postgres connection
conn = psycopg2.connect(
    dbname="spectre",
    user="postgres",
    password="123456789",
    host="localhost",
    port="5432"
)

# Mongodb connection
client = MongoClient("mongodb+srv://ak:cO861EI5Kpfy6k2R@cluster0.jscsiwg.mongodb.net/")
db = client.Spectre
agents = db.agents 

query = "SELECT * FROM agents"
cur = conn.cursor()
cur.execute(query)
rows = cur.fetchall()

for row in rows:
    doc = {
           "acode": row[0], "fname": row[1], "lname": row[2], "dob": f'{row[3].year}-{row[3].month}-{row[3].day}',
            "gender": row[4], "nationality": row[5], "security_level": row[6], "agent_type": row[7], "agent_status": row[8]
          }
    agents.insert_one(doc)                                                       

cur.close()                                                           
conn.close()
client.close()
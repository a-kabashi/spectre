import pymongo
from pymongo import MongoClient
from neo4j import GraphDatabase

#Neo4j connection
#
#
#Define the URI, username, and password for your Neo4j database
uri = "bolt://localhost:7687"
username = "neo4j"
password = "123456789"

# Create a connection to the database
driver = GraphDatabase.driver(uri, auth=(username, password))


# Mongodb Connection
#
#
client = MongoClient("mongodb+srv://ak:cO861EI5Kpfy6k2R@cluster0.jscsiwg.mongodb.net/")
db = client.Spectre
missions = db.missions

# Function for run()
def run_query(query, para):
    with driver.session() as session:
        result = session.run(query, para)
        return result
		
# retrieve the data from Mongodb DB
docs = missions.find()

for doc in docs:
    query = '''
                MERGE (m:missions{
                    mid: $mid,
                    general_description: $general_description,
                    city: $city,
                    country: $country,
                    start_date: $start_date,
                    end_date: $end_date,
                    mstatus: $mstatus
                })
                RETURN m
            '''
    para = {
                'mid': doc['mid'],
                'general_description': doc['general_description'],
                'city': doc['city'],
                'country': doc['country'],
                'start_date': doc['start_date'],
                'end_date': doc['end_date'],
                'mstatus': doc['mstatus']
            }

    print(run_query(query,para))
	
driver.close()
client.close()